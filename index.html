<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Generator Zaproszeń Ślubnych</title>
  
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background-color: #f5f5f5;
    }
    
    h1 {
      color: #333;
      text-align: center;
    }
    
    .container {
      max-width: 800px;
      margin: 0 auto;
      background-color: white;
      padding: 20px;
      border-radius: 5px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    
    .button {
      background-color: #4CAF50;
      border: none;
      color: white;
      padding: 10px 20px;
      text-align: center;
      text-decoration: none;
      display: inline-block;
      font-size: 16px;
      margin: 10px 2px;
      cursor: pointer;
      border-radius: 4px;
    }
    
    .preview {
      width: 100%;
      height: 500px;
      border: 1px solid #ddd;
      margin-top: 20px;
    }
    
    .status {
      margin-top: 20px;
      padding: 10px;
      background-color: #f8f8f8;
      border-left: 5px solid #4CAF50;
    }
    
    .guest-list {
      margin-top: 20px;
      height: 300px;
      overflow-y: auto;
      border: 1px solid #ddd;
      padding: 10px;
    }
    
    .guest-item {
      padding: 5px;
      cursor: pointer;
    }
    
    .guest-item:hover {
      background-color: #f0f0f0;
    }
    
    .selected {
      background-color: #e0e0e0;
    }
    
    @media print {
      .container, .button, .guest-list, h1, .status {
        display: none;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Generator Zaproszeń Ślubnych</h1>
    
    <div>
      <p>Kliknij na gościa z listy, aby wygenerować zaproszenie. Następnie zapisz stronę jako PDF (użyj Ctrl+P i wybierz opcję "Zapisz jako PDF").</p>
      <button class="button" id="printButton">Drukuj aktualne zaproszenie</button>
    </div>
    
    <div class="guest-list" id="guestList">
      <!-- Lista gości będzie wygenerowana przez JavaScript -->
    </div>
    
    <div class="status" id="status">
      Wybierz gościa z listy, aby wygenerować zaproszenie.
    </div>
    
    <iframe id="previewFrame" class="preview"></iframe>
  </div>
  
  <div id="printArea" style="display:none;"></div>
  
  <script>
    // Lista gości
    const guestList = [
      // Rodzina Pani Młodej
      "Rodziców Alicję oraz Sławomira Zawada",
      "Karolinę, Dawida oraz Izabelkę Stelmach",
      "Babcię Franię Gawlik",
      "Natalię oraz Aleksandra Zawadę",
      "Ciocię Beatę wraz z Krzysztofem Milerskim oraz Sylwią Gawlik",
      "Mateusza Gawlika oraz Gosię Krzywon",
      "Magdę Gawlik-Wrzeszcz oraz Filipa Wrzeszcz",
      "Jowitę Gawlik wraz z osobą towarzyszącą, Amelkę Chmiel oraz Adasia",
      "Rodziców chrzestnych Ciocię Ewę oraz Wujka Mietka Gawlik",
      "Anię oraz Krzyśka Staniek wraz z dziećmi",
      "Ciocię Aurelię Kohut wraz z osobą towarzyszącą",
      
      // Rodzina Pana Młodego
      "Rodziców Adriannę oraz Rafała wraz z Niną Dziedzic",
      "Babcię Łucję oraz Dziadka Stanisława Dziedzic",
      "Babcię Łucję Madzię",
      "Weronikę oraz Wojciecha Swobodów",
      "Łukasza oraz Magdalenę wraz z Ksawerym Madzia",
      "Beatę oraz Piotra wraz z Martyną i Dawidem Glajc",
      "Martę Dziedzic, Krzysztofa Orela wraz z Bartoszem",
      "Barbarę oraz Marka Pylicę",
      "Sylwię Krzemień-Kolasińską wraz z osobą towarzyszącą",
      
      // Znajomi
      "Rafała Nawodyło wraz z osobą towarzyszącą",
      "Wojciecha Foltyna wraz z osobą towarzyszącą",
      "Szymona Huplika wraz z osobą towarzyszącą",
      "Piotra Waliczka wraz z osobą towarzyszącą",
      "Annę oraz Krzysztofa Macura",
      "Krystiana Urbańskiego wraz z osobą towarzyszącą",
      "Arkadiusza Szczypkę oraz Agnieszkę Fizek",
      "Wiktorię Malec oraz Przemysława Tomicę",
      "Aleksandrę oraz Eryka Sztwiertnię",
      "Arkadiusza Strokę oraz Marcina Żaka",
      "Victorię Ogorzelec oraz Michała Zontka",
      "Dominikę Obracaj oraz Mateusza Kumorka",
      "Weronikę oraz Dawida Jankowskich",
      "Klaudię oraz Jakuba Ferfeckich",
      "Agnieszkę Kucharską wraz z osobą towarzyszącą",
      "Magdalenę oraz Sebastiana Wróbel",
      "Magdalenę Grudzień wraz z osobą towarzyszącą",
      "Adama oraz Aleksandrę Woźnicę", 
      "Mateusza Brudnego",
      "Łukasza Pszczółkę"
    ];
    
    // Pobranie HTMLa szablonu zaproszenia
    const invitationTemplate = `
<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Natalia & Konrad - Zaproszenie ślubne</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Italiana&family=Cormorant:ital,wght@0,300;0,400;0,500;1,300;1,400&family=Montserrat:wght@300;400;500&display=swap" rel="stylesheet">

  <style>
    :root {
      --primary-color: #2d2d2d;
      --accent-color: rgba(180, 160, 120, 0.7);
      --background-color: #ffffff;
      --spacing-unit: 7px;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      background-color: var(--background-color);
      color: var(--primary-color);
      font-family: 'Cormorant', serif;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: calc(var(--spacing-unit) * 1);
    }

    .invitation-wrapper {
      position: relative;
      width: 105mm;
      height: 148mm;
      overflow: hidden;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      background-color: #fff;
    }

    .invitation {
      position: relative;
      height: 100%;
      width: 100%;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: calc(var(--spacing-unit) * 1.8);
      text-align: center;
    }

    .border-frame {
      position: absolute;
      top: calc(var(--spacing-unit) * 1.2);
      left: calc(var(--spacing-unit) * 1.2);
      right: calc(var(--spacing-unit) * 1.2);
      bottom: calc(var(--spacing-unit) * 1.2);
      border: 1px solid var(--accent-color);
      pointer-events: none;
    }

    .content {
      position: relative;
      width: 100%;
      max-width: 85mm;
      z-index: 2;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .monogram-container {
      position: relative;
      margin: 0 auto calc(var(--spacing-unit) * 1.5);
      width: 120px;
      height: 70px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .monogram-divider {
      position: absolute;
      height: 70px;
      width: 1px;
      background: linear-gradient(to bottom, transparent, var(--accent-color), transparent);
      left: 50%;
      top: 0;
    }

    .monogram {
      position: absolute;
      font-family: 'Italiana', serif;
      font-size: 60px;
      line-height: 1;
      color: var(--primary-color);
    }

    .n-letter {
      left: 8px;
    }

    .k-letter {
      right: 8px;
    }

    .names {
      font-family: 'Montserrat', sans-serif;
      font-size: 11px;
      letter-spacing: 1.5px;
      font-weight: 300;
      text-transform: uppercase;
      margin-bottom: calc(var(--spacing-unit) * 1.5);
      color: var(--primary-color);
    }

    .invite-text {
      font-size: 11px;
      line-height: 1.6;
      margin-bottom: calc(var(--spacing-unit) * 1.2);
      font-weight: 400;
    }

    .guest-name {
      font-style: italic;
      font-weight: 400;
      font-size: 13px;
      margin: calc(var(--spacing-unit) * 0.5) 0;
      color: var(--primary-color);
      display: block;
    }

    .date-container {
      display: flex;
      justify-content: center;
      align-items: center;
      margin: calc(var(--spacing-unit) * 1) 0;
    }

    .date-line {
      height: 1px;
      width: 40px;
      background-color: var(--primary-color);
    }

    .date {
      margin: 0 calc(var(--spacing-unit) * 1);
      font-size: 28px;
      font-weight: 400;
      font-family: 'Italiana', serif;
    }

    .date-details {
      display: flex;
      justify-content: space-between;
      width: 100%;
      max-width: 75mm;
      margin: 0 auto calc(var(--spacing-unit) * 0.8);
      font-family: 'Montserrat', sans-serif;
      font-size: 8px;
      letter-spacing: 1px;
      text-transform: uppercase;
      color: var(--primary-color);
      font-weight: 300;
    }

    .location {
      margin-top: calc(var(--spacing-unit) * 1.5);
      font-style: italic;
      font-size: 13px;
      line-height: 1.5;
    }

    .divider {
      height: 1px;
      width: 40px;
      background-color: var(--primary-color);
      margin: calc(var(--spacing-unit) * 1.5) auto;
      opacity: 0.5;
    }

    .reception-text {
      font-size: 11px;
      line-height: 1.5;
      margin-bottom: calc(var(--spacing-unit) * 1);
      font-weight: 400;
    }

    .reception-location {
      font-style: italic;
      font-size: 13px;
      line-height: 1.5;
      margin-bottom: calc(var(--spacing-unit) * 0.4);
    }

    .reception-address {
      font-size: 10px;
      line-height: 1.4;
      margin-bottom: calc(var(--spacing-unit) * 1);
    }

    .additional-info {
      font-size: 11px;
      font-style: italic;
      line-height: 1.6;
      margin-top: calc(var(--spacing-unit) * 2);
      color: var(--primary-color);
    }

    @media print {
      body {
        background: none;
        padding: 0;
        margin: 0;
        font-size: initial;
        page-break-after: avoid;
        page-break-before: avoid;
        page-break-inside: avoid;
      }

      .invitation-wrapper {
        box-shadow: none;
        margin: 0;
        width: 105mm;
        height: 148mm;
        page-break-after: avoid;
        page-break-before: avoid;
        page-break-inside: avoid;
      }

      @page {
        size: 105mm 148mm;
        margin: 0;
      }
    }
  </style>
</head>
<body>
  <div class="invitation-wrapper">
    <div class="invitation">
      <div class="border-frame"></div>

      <div class="content">
        <div class="monogram-container">
          <div class="monogram-divider"></div>
          <div class="monogram n-letter">N</div>
          <div class="monogram k-letter">K</div>
        </div>

        <div class="names">NATALIA ZAWADA I KONRAD DZIEDZIC</div>

        <div class="invite-text">
          z radością zapraszają<br>
          <span class="guest-name">GUEST_NAME_PLACEHOLDER</span>
          na uroczystość zaślubin,<br>
          która odbędzie się
        </div>

        <div class="date-container">
          <div class="date-line"></div>
          <div class="date">9</div>
          <div class="date-line"></div>
        </div>

        <div class="date-details">
          <span>PAŹDZIERNIK</span>
          <span>2025</span>
          <span>GODZ. 13:00</span>
        </div>

        <div class="location">
          w Kościele św. Piotra i Pawła<br>
          w Skoczowie
        </div>

        <div class="divider"></div>

        <div class="reception-text">
          Po uroczystości zaślubin mamy zaszczyt zaprosić Was<br>
          na przyjęcie weselne, które odbędzie się
        </div>

        <div class="reception-location">
          w Winnicy Toskańskiej Romeo i Julia
        </div>

        <div class="reception-address">
          ul. Myśliwska 1, 43-370 Szczyrk
        </div>

        <div class="additional-info">
          „Przy Tobie<br>każde miejsce staje się domem."
        </div>
      </div>
    </div>
  </div>
</body>
</html>`;
    
    // Funkcja do wygenerowania spersonalizowanego zaproszenia
    function generateInvitation(guestName) {
      // Zastąp placeholder imieniem gościa
      return invitationTemplate.replace('GUEST_NAME_PLACEHOLDER', guestName);
    }
    
    // Funkcja do czyszczenia nazwy dla pliku
    function cleanFileName(name) {
      return name
        .replace(/[\/\\:*?"<>|]/g, '_')
        .replace(/[ąćęłńóśźż]/gi, function(match) {
          const polishChars = {
            'ą': 'a', 'ć': 'c', 'ę': 'e', 'ł': 'l', 'ń': 'n', 
            'ó': 'o', 'ś': 's', 'ź': 'z', 'ż': 'z',
            'Ą': 'A', 'Ć': 'C', 'Ę': 'E', 'Ł': 'L', 'Ń': 'N', 
            'Ó': 'O', 'Ś': 'S', 'Ź': 'Z', 'Ż': 'Z'
          };
          return polishChars[match] || match;
        })
        .replace(/\s+/g, '_');
    }
    
    // Wygeneruj listę gości
    const guestListElement = document.getElementById('guestList');
    guestList.forEach((guest, index) => {
      const guestItem = document.createElement('div');
      guestItem.className = 'guest-item';
      guestItem.textContent = guest;
      guestItem.setAttribute('data-index', index);
      
      guestItem.addEventListener('click', function() {
        // Usuń zaznaczenie z poprzednio wybranego gościa
        const selectedItems = document.querySelectorAll('.guest-item.selected');
        selectedItems.forEach(item => item.classList.remove('selected'));
        
        // Zaznacz klikniętego gościa
        this.classList.add('selected');
        
        // Wygeneruj zaproszenie
        const guestName = this.textContent;
        const invitation = generateInvitation(guestName);
        
        // Wyświetl w iframe
        const previewFrame = document.getElementById('previewFrame');
        previewFrame.srcdoc = invitation;
        
        // Zapisz do drukowania
        const printArea = document.getElementById('printArea');
        printArea.innerHTML = invitation;
        
        // Aktualizuj status
        document.getElementById('status').textContent = `Wygenerowano zaproszenie dla: ${guestName}`;
        
        // Aktualizuj tytuł przycisku drukowania
        document.getElementById('printButton').textContent = `Drukuj zaproszenie dla: ${guestName}`;
      });
      
      guestListElement.appendChild(guestItem);
    });
    
    // Obsługa przycisku drukowania
    document.getElementById('printButton').addEventListener('click', function() {
      const selectedItem = document.querySelector('.guest-item.selected');
      
      if (selectedItem) {
        const guestName = selectedItem.textContent;
        const cleanName = cleanFileName(guestName);
        
        // Ustaw nazwę pliku PDF
        const styleElement = document.createElement('style');
        styleElement.textContent = `
          @media print {
            @page {
              size: 105mm 148mm;
              margin: 0;
            }
          }
        `;
        document.head.appendChild(styleElement);
        
        // Wydrukuj tylko iframe
        const printFrame = document.getElementById('previewFrame');
        printFrame.focus();
        printFrame.contentWindow.print();
      } else {
        alert('Najpierw wybierz gościa z listy!');
      }
    });
    
    // Automatycznie wybierz pierwszego gościa
    if (guestList.length > 0) {
      const firstGuestItem = document.querySelector('.guest-item');
      if (firstGuestItem) {
        firstGuestItem.click();
      }
    }
  </script>
</body>
</html> 
